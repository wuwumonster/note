## 漏洞影响范围
WebWork 2.1 (with altSyntax enabled), WebWork 2.2.0 - WebWork 2.2.5, Struts 2.0.0 - Struts 2.0.8

## 漏洞成因

## 流程分析
**断点位置**
这里的配置是是将所有的请求交给Struts2来处理
![](attachments/Pasted%20image%2020230330064504.png)

所以断点位置直接放在org.apache.struts2.dispatcher.FilterDispatcher的doFilter

![](attachments/Pasted%20image%2020230330064920.png)

请求基本跳转

![](attachments/Pasted%20image%2020230330065258.png)

进入dofilter后，经过一些判断，mapping肯定是不为null的，到serviceAction的位置

![](attachments/Pasted%20image%2020230330065757.png)

这里的serviceAction和我们之前配置的LoginAction联系

基本上就是将Action对象引入，这里是做了应该valueStack的判断，在环境里的struts.xml拿到mapping，进而获取到我们的LoginClass，一些细节上的东西就不看了

![](attachments/Pasted%20image%2020230330070340.png)

这里直接到execute

![](attachments/Pasted%20image%2020230330070550.png)

在这里进入invoke后，由应该interceptors的迭代器在做操作，遍历了一遍拦截器

![](attachments/Pasted%20image%2020230330071116.png)

具体拦截器的列表事实上在前面已经getconfiguration了

![](attachments/Pasted%20image%2020230330124302.png)


朝这个位置找的话是找到一个对参数进行处理的拦截器的

![](attachments/Pasted%20image%2020230330124835.png)

方便调试，在这里下一个断点

![](attachments/Pasted%20image%2020230330125249.png)

这里获取了context，然后从中取出访问的参数

![](attachments/Pasted%20image%2020230330125811.png)

中间过程可以忽略，最后是set到了action中

![](attachments/Pasted%20image%2020230330130215.png)

通过setvalue放进来

![](attachments/Pasted%20image%2020230330130329.png)

这里有一个遍历iterator

![](attachments/Pasted%20image%2020230330130748.png)

所有的拦截器遍历完之后，回进入这个invokeActionOnly()

![](attachments/Pasted%20image%2020230330131025.png)

![](attachments/Pasted%20image%2020230330131614.png)

这里面就已经再用execute来处理

![](attachments/Pasted%20image%2020230330131916.png)

结束后回到了DefaultActionInvo'ca'tuiocation，走到executeResult

![](attachments/Pasted%20image%2020230330132028.png)

这里的配置已经是我们的index.jsp

![](attachments/Pasted%20image%2020230330132248.png)