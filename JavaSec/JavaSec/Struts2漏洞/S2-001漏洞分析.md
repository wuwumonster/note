## 漏洞影响范围
WebWork 2.1 (with altSyntax enabled), WebWork 2.2.0 - WebWork 2.2.5, Struts 2.0.0 - Struts 2.0.8

## 漏洞成因

## 流程分析
**断点位置**
这里的配置是是将所有的请求交给Struts2来处理
![](attachments/Pasted%20image%2020230330064504.png)

所以断点位置直接放在org.apache.struts2.dispatcher.FilterDispatcher的doFilter

![](attachments/Pasted%20image%2020230330064920.png)

请求基本跳转

![](attachments/Pasted%20image%2020230330065258.png)

进入dofilter后，经过一些判断，mapping肯定是不为null的，到serviceAction的位置

![](attachments/Pasted%20image%2020230330065757.png)

这里的serviceAction和我们之前配置的LoginAction联系

基本上就是将Action对象引入，这里是做了应该valueStack的判断，在环境里的struts.xml拿到mapping，进而获取到我们的LoginClass，一些细节上的东西就不看了

![](attachments/Pasted%20image%2020230330070340.png)

这里直接到execute

![](attachments/Pasted%20image%2020230330070550.png)

在这里进入invoke后，由应该interceptors的迭代器在做操作，遍历了一遍拦截器

![](attachments/Pasted%20image%2020230330071116.png)

可以看出来在invoke里面取到了我们的LoginAction


