## 影响范围
likeshop <= v2.5.7
## 漏洞分析
直接从漏洞功能点开始`server/application/api/controller/File.php`

![](attachments/Pasted%20image%2020241020154907.png)

跟入`server/application/common/server/FileServer.php#userFormImage`这里可以看到默认使用的`engine`是local

![](attachments/Pasted%20image%2020241020155033.png)

跟入`server/application/common/server/storage/Driver.php#setUploadFile`这里没有对上传的文件做任何限制

![](attachments/Pasted%20image%2020241020155320.png)

接着看`server/application/common/server/FileServer.php#userFormImage`调用的的upload，这里选取的是上传到local的engine

![](attachments/Pasted%20image%2020241020155545.png)
同样没有对文件的任何检查，直接完成了上传
![](attachments/Pasted%20image%2020241020155608.png)
## POC
直接在系统的头像处上传即可触发

```BURP
POST /api/file/formimage HTTP/1.1
```

