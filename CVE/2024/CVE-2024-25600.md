## 影响范围
WordPress Bricks Builder <= 1.9.6

## 漏洞分析
`wp-content/themes/bricks/includes/query.php`

```PHP
public static function prepare_query_vars_from_settings( $settings = [], $fallback_element_id = '' ) {  
    $query_vars = $settings['query'] ?? [];  
  
    // Some elements already built the query vars. (carousel, related-posts) (@since 1.9.3)  
    if ( isset( $query_vars['bricks_skip_query_vars'] ) ) {  
       return $query_vars;  
    }  
  
    // Unset infinite scroll  
    if ( isset( $query_vars['infinite_scroll'] ) ) {  
       unset( $query_vars['infinite_scroll'] );  
    }  
  
    // Do not use meta_key if orderby is not set to meta_value or meta_value_num (@since 1.8)  
    if ( isset( $query_vars['meta_key'] ) ) {  
       $orderby = isset( $query_vars['orderby'] ) ? $query_vars['orderby'] : '';  
       if ( ! in_array( $orderby, [ 'meta_value', 'meta_value_num' ] ) ) {  
          unset( $query_vars['meta_key'] );  
       }  
    }  
  
    $object_type = self::get_query_object_type();  
    $element_id  = self::get_query_element_id();
```