### 热身
ctfshow{一个不能说的秘密}

## Web
### easy_signin
看到url中的base64，应该是文件包含，读index.php

```php
<?php
/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2023-03-27 10:30:30
# @Last Modified by:   h1xa
# @Last Modified time: 2023-03-28 12:15:33
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/

$image=$_GET['img'];

$flag = "ctfshow{9ce9236e-2124-4bdc-a4ab-813c9948bf2a}";
if(isset($image)){
	$image = base64_decode($image);
	$data = base64_encode(file_get_contents($image));
	echo "<img src='data:image/png;base64,$data'/>";
}else{
	$image = base64_encode("face.png");
	header("location:/?img=".$image);
}


```


### 被遗忘的反序列化

index.php
```php
<?php  
  
# 当前目录中有一个txt文件哦  
error_reporting(0);  
show_source(__FILE__);  
include("check.php");  
  
class EeE{  
    public $text;  
    public $eeee;  
    public function __wakeup(){  
        if ($this->text == "aaaa"){  
            echo lcfirst($this->text);  
        }  
    }  
  
    public function __get($kk){  
        echo "$kk,eeeeeeeeeeeee";  
    }  
  
    public function __clone(){        
	    $a = new cycycycy;        
	    $a -> aaa();  
    }  
      
}  
  
class cycycycy{  
    public $a;  
    private $b;  
  
    public function aaa(){        
	    $get = $_GET['get'];        
	    $get = cipher($get);  
        if($get === "p8vfuv8g8v8py"){  
            eval($_POST["eval"]);  
        }  
    }  
  
  
    public function __invoke(){        $a_a = $this -> a;  
        echo "\$a_a\$";  
    }  
}  
  
class gBoBg{  
    public $name;  
    public $file;  
    public $coos;  
    private $eeee="-_-";  
    public function __toString(){  
        if(isset($this->name)){            
	        $a = new $this->coos($this->file);  
            echo $a;  
        }else if(!isset($this -> file)){  
            return $this->coos->name;  
        }else{            
	        $aa = $this->coos;            
	        $bb = $this->file;  
            return $aa();  
        }  
    }  
}     
  
class w_wuw_w{  
    public $aaa;  
    public $key;  
    public $file;  
    public function __wakeup(){  
        if(!preg_match("/php|63|\*|\?/i",$this -> key)){            
	        $this->key = file_get_contents($this -> file);  
        }else{  
            echo "不行哦";  
        }  
    }  
  
    public function __destruct(){  
        echo $this->aaa;  
    }  
  
    public function __invoke(){        
	    $this -> aaa = clone new EeE;  
    }  
}  
  
$_ip = $_SERVER["HTTP_AAAAAA"];  
unserialize($_ip);

```

### easy_ssti
F12
![](attachments/Pasted%20image%2020230401110342.png)

